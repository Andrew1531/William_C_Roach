import React, { useState, useEffect } from 'react';
import { 
  ExternalLink, 
  Menu, 
  X, 
  ArrowUpRight, 
  Mic2, 
  Book, 
  ChevronRight, 
  Play, 
  GraduationCap, 
  ShieldCheck, 
  BookOpen, 
  Scale, 
  Feather, 
  Twitter, 
  Youtube, 
  Mail 
} from 'lucide-react';

const App = () => {
  const [activeTab, setActiveTab] = useState('home');
  const [isMenuOpen, setIsMenuOpen] = useState(false);
  const [isScrolled, setIsScrolled] = useState(false);
  
  // Custom Form State Management
  const [formStatus, setFormStatus] = useState('idle'); // idle, submitting, success, error
  const [formErrors, setFormErrors] = useState({});

  useEffect(() => {
    const handleScroll = () => {
      setIsScrolled(window.scrollY > 50);
    };
    window.addEventListener('scroll', handleScroll);
    return () => window.removeEventListener('scroll', handleScroll);
  }, []);

  const navigate = (tabId) => {
    setActiveTab(tabId);
    setIsMenuOpen(false);
    window.scrollTo({ top: 0, behavior: 'smooth' });
  };

  const handleFormSubmit = async (e) => {
    e.preventDefault();
    setFormStatus('submitting');
    setFormErrors({});

    const formData = new FormData(e.target);
    
    try {
      // Using the specific endpoint provided: mlgwgkyy
      const response = await fetch("https://formspree.io/f/mlgwgkyy", {
        method: "POST",
        body: formData,
        headers: {
          'Accept': 'application/json'
        }
      });

      if (response.ok) {
        setFormStatus('success');
        e.target.reset();
      } else {
        const data = await response.json();
        if (data.errors) {
          setFormErrors(data.errors.reduce((acc, err) => {
            acc[err.field || 'generic'] = err.message;
            return acc;
          }, {}));
        }
        setFormStatus('error');
      }
    } catch (error) {
      setFormStatus('error');
    }
  };

  const NavLink = ({ id, label }) => (
    <button 
      onClick={() => navigate(id)} 
      className={`text-[11px] font-black uppercase tracking-widest transition-all relative pb-1 border-b-2 ${
        activeTab === id ? 'text-white border-white' : 'text-zinc-500 border-transparent hover:text-white'
      }`}
    >
      {label}
    </button>
  );

  return (
    <div className="bg-[#0a0a0a] text-[#e5e5e5] font-sans selection:bg-white selection:text-black min-h-screen overflow-x-hidden">
      
      {/* Navigation */}
      <nav className={`fixed top-0 w-full z-50 transition-all duration-500 ${
        isScrolled ? 'bg-black/95 backdrop-blur-md border-b border-white/5 py-4' : 'bg-transparent py-8'
      }`}>
        <div className="max-w-7xl mx-auto px-6 flex items-center justify-between">
          <div className="flex flex-col cursor-pointer group" onClick={() => navigate('home')}>
            <span className="text-xl md:text-2xl font-black tracking-tighter uppercase leading-none text-white">William C. Roach</span>
            <span className="text-[9px] md:text-[10px] font-bold tracking-[0.15em] uppercase text-zinc-500 group-hover:text-white transition-colors">
              The Objective Faith: Dialogues in Classical Christian Truth
            </span>
          </div>

          <div className="hidden lg:flex items-center gap-10">
            <NavLink id="home" label="home" />
            <NavLink id="videos" label="videos" />
            <NavLink id="books" label="books" />
            <NavLink id="about" label="about" />
          </div>

          <div className="flex items-center gap-4">
            <a href="https://drbillroach.substack.com/" target="_blank" rel="noopener noreferrer" className="hidden sm:flex items-center gap-2 border border-white/20 hover:border-white px-5 py-2 text-[10px] font-black uppercase tracking-[0.2em] transition-all text-white">
              Substack <ExternalLink className="w-3 h-3" />
            </a>
            <button className="lg:hidden text-white" onClick={() => setIsMenuOpen(true)}>
              <Menu />
            </button>
          </div>
        </div>
      </nav>

      {/* Mobile Menu */}
      {isMenuOpen && (
        <div className="fixed inset-0 z-[60] bg-black flex flex-col items-center justify-center gap-8 animate-in fade-in duration-300">
          <button onClick={() => navigate('home')} className="text-4xl font-black uppercase tracking-tighter italic text-white">home</button>
          <button onClick={() => navigate('videos')} className="text-4xl font-black uppercase tracking-tighter italic text-white">videos</button>
          <button onClick={() => navigate('books')} className="text-4xl font-black uppercase tracking-tighter italic text-white">books</button>
          <button onClick={() => navigate('about')} className="text-4xl font-black uppercase tracking-tighter italic text-white">about</button>
          <a href="https://drbillroach.substack.com/" target="_blank" rel="noopener noreferrer" className="text-xl font-black uppercase tracking-widest text-zinc-500 flex items-center gap-2">
            Substack <ExternalLink className="w-4 h-4" />
          </a>
          <button onClick={() => setIsMenuOpen(false)} className="absolute top-8 right-6 text-white">
            <X />
          </button>
        </div>
      )}

      <main className="pt-40">
        {/* Home Tab */}
        {activeTab === 'home' && (
          <div className="animate-in slide-in-from-bottom-2 duration-500 max-w-7xl mx-auto px-6">
            <section className="mb-32 border-l border-white/10 pl-8 md:pl-16">
              <div className="max-w-4xl">
                <div className="flex items-center gap-4 mb-6">
                  <div className="h-[1px] w-12 bg-white/30"></div>
                  <span className="text-[10px] font-black uppercase tracking-[0.4em] text-zinc-400">Pursuing the objective Christian faith for the modern mind</span>
                </div>
                <h1 className="text-6xl md:text-[9rem] font-black tracking-tighter mb-8 leading-[0.85] text-white uppercase italic">
                  Defend <br />
                  <span className="not-italic">The Faith.</span>
                </h1>
                <p className="text-xl md:text-2xl text-zinc-400 mb-12 max-w-2xl leading-relaxed font-light">
                  Bridging the gap between the academy and the local church. Pursuing historical Reformed theology for the contemporary mind.
                </p>
                <div className="flex flex-col sm:flex-row gap-6">
                  <button onClick={() => navigate('books')} className="bg-white text-black px-12 py-5 text-sm font-black uppercase tracking-widest hover:bg-transparent hover:text-white border border-white transition-all flex items-center justify-center gap-3">
                    Published Works <ArrowUpRight className="w-4 h-4" />
                  </button>
                  <a href="#subscribe-section" className="border border-white/20 hover:border-white px-12 py-5 text-sm font-black uppercase tracking-widest transition-all text-white flex items-center justify-center gap-3">
                    Join Newsletter
                  </a>
                </div>
              </div>
            </section>

            <div className="grid grid-cols-1 md:grid-cols-12 gap-px bg-white/10 border border-white/10 mb-40">
              <div className="md:col-span-8 bg-[#0a0a0a] p-12 hover:bg-[#0f0f0f] transition-colors cursor-pointer group" onClick={() => navigate('videos')}>
                <div className="flex items-center justify-between mb-20">
                  <Mic2 className="text-white w-8 h-8" />
                  <span className="text-[10px] font-black tracking-[0.3em] uppercase text-zinc-500">Podcast & Lectures</span>
                </div>
                <h2 className="text-4xl font-black uppercase tracking-tighter mb-4 italic text-white group-hover:translate-x-2 transition-transform">Timeless Dialogues</h2>
                <p className="text-zinc-500 max-w-sm mb-12">Engaging in the deep intellectual tradition of the church. Currently rebranding as <span className="text-zinc-300 italic">The Thinking Faith</span>.</p>
                <div className="flex items-center gap-2 text-white font-black text-[10px] uppercase tracking-[0.2em]">
                  Watch on YouTube <ChevronRight className="w-3 h-3" />
                </div>
              </div>
              <div className="md:col-span-4 bg-[#0a0a0a] p-12 hover:bg-[#0f0f0f] transition-colors cursor-pointer group" onClick={() => navigate('books')}>
                <div className="flex items-center justify-between mb-20">
                  <Book className="text-white w-8 h-8" />
                  <span className="text-[10px] font-black tracking-[0.3em] uppercase text-zinc-500">Academic Catalog</span>
                </div>
                <h2 className="text-4xl font-black uppercase tracking-tighter mb-4 text-white group-hover:translate-x-2 transition-transform">Books</h2>
                <p className="text-zinc-500 mb-12 italic">From Inerrancy to Hermeneutics.</p>
                <div className="flex items-center gap-2 text-white font-black text-[10px] uppercase tracking-[0.2em]">
                  Amazon Author Page <ChevronRight className="w-3 h-3" />
                </div>
              </div>
            </div>
          </div>
        )}

        {/* Books Tab */}
        {activeTab === 'books' && (
          <div className="animate-in slide-in-from-bottom-2 duration-500 max-w-7xl mx-auto px-6 pb-40">
            <div className="flex flex-col md:flex-row justify-between items-baseline mb-20 gap-8">
              <h2 className="text-6xl md:text-[8rem] font-black tracking-tighter uppercase italic leading-none text-white">Books</h2>
              <a href="https://www.amazon.com/stores/William-C.-Roach/author/B01B22KJ1Y" target="_blank" rel="noopener noreferrer" className="text-[10px] font-black uppercase tracking-widest border border-white/20 px-8 py-4 hover:bg-white hover:text-black transition-all text-white flex items-center gap-3">
                View Complete Catalog (Print Copies) <ExternalLink className="w-3 h-3" />
              </a>
            </div>
            <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-px bg-white/10 border border-white/10">
              {['Defending Inerrancy', 'Hermeneutics as Epistemology', 'Sola Fide'].map((title, i) => (
                <div key={i} className="bg-black p-12 hover:bg-[#0d0d0d] transition-colors group">
                  <span className="text-[10px] font-black text-zinc-500 uppercase tracking-widest mb-12 block">
                    {i === 0 ? 'Featured Work' : i === 1 ? 'Academic Inquiry' : 'Historical Doctrine'}
                  </span>
                  <h3 className="text-3xl font-black uppercase mb-4 leading-tight text-white group-hover:italic transition-all">{title}</h3>
                  <p className="text-zinc-400 mb-12 font-light leading-relaxed">
                    {i === 0 ? 'Affirming the high view of Scripture in a postmodern world.' : 
                     i === 1 ? 'A philosophical inquiry into how we interpret sacred texts.' : 
                     'Exploring the bedrock of the Reformation for today.'}
                  </p>
                  <a href="https://www.amazon.com/stores/William-C.-Roach/author/B01B22KJ1Y" target="_blank" rel="noopener noreferrer" className="text-[10px] font-black uppercase tracking-widest flex items-center gap-2 border-b border-white pb-1 w-fit text-white">Get Print Copy</a>
                </div>
              ))}
            </div>
          </div>
        )}

        {/* Videos Tab */}
        {activeTab === 'videos' && (
          <div className="animate-in slide-in-from-bottom-2 duration-500 max-w-7xl mx-auto px-6 pb-40">
            <h2 className="text-6xl md:text-[8rem] font-black tracking-tighter uppercase italic leading-none mb-20 text-white">Videos</h2>
            <div className="grid grid-cols-1 md:grid-cols-2 gap-12">
              <div className="group border-b border-white/10 pb-12">
                <div className="aspect-video bg-zinc-900 mb-6 relative overflow-hidden flex items-center justify-center">
                  <Play className="w-16 h-16 text-white/10 group-hover:text-white/50 transition-all" />
                </div>
                <h3 className="text-3xl font-black uppercase tracking-tighter mb-4 text-white group-hover:italic transition-all">Timeless Dialogues with Dr. Roach</h3>
                <p className="text-zinc-500 mb-6">Current podcast episodes exploring classical Christian truth. (Upcoming rebrand: The Thinking Faith)</p>
                <a href="https://www.youtube.com/@DrBillRoach" target="_blank" rel="noopener noreferrer" className="inline-block text-[10px] font-black uppercase tracking-widest border border-white/20 px-6 py-3 hover:bg-white hover:text-black transition-all text-white">Watch on YouTube</a>
              </div>
              <div className="group border-b border-white/10 pb-12">
                <div className="aspect-video bg-zinc-900 mb-6 relative overflow-hidden flex items-center justify-center">
                  <GraduationCap className="w-16 h-16 text-white/10 group-hover:text-white/50 transition-all" />
                </div>
                <h3 className="text-3xl font-black uppercase tracking-tighter mb-4 text-white group-hover:italic transition-all">Academic Lectures</h3>
                <p className="text-zinc-500 mb-6">Lectures on apologetics and philosophical theology from across North and South America.</p>
                <a href="https://www.youtube.com/@DrBillRoach" target="_blank" rel="noopener noreferrer" className="inline-block text-[10px] font-black uppercase tracking-widest border border-white/20 px-6 py-3 hover:bg-white hover:text-black transition-all text-white">Browse Archive</a>
              </div>
            </div>
          </div>
        )}

        {/* About Tab */}
        {activeTab === 'about' && (
          <div className="animate-in slide-in-from-bottom-2 duration-500 max-w-7xl mx-auto px-6 pb-40">
            <h2 className="text-6xl md:text-[8rem] font-black tracking-tighter uppercase italic leading-none mb-20 text-white">About</h2>
            <div className="grid grid-cols-1 md:grid-cols-12 gap-20">
              <div className="md:col-span-8">
                <p className="text-3xl md:text-4xl font-light leading-snug text-zinc-300 italic mb-12">
                  "William (Bill) C. Roach, Ph.D. stands at the intersection of historic Evangelical theology and Classical philosophy."
                </p>
                <div className="space-y-8 text-zinc-400 text-lg leading-loose font-light">
                  <p>
                    William (Bill) C. Roach, Ph.D. serves as Dean of the Norman L. Geisler School of Apologetics at Veritas International University and Dean of Systematic Theology at Redeemer Seminary.
                  </p>
                  <p>
                    Dr. Roach has been featured in <span className="text-white italic">Christianity Today</span> and <span className="text-white italic">World Magazine</span> for his contributions to apologetics. He is the Past President of the International Society of Christian Apologetics.
                  </p>
                  <p>
                    Some of his published works include <span className="text-white">Defending Inerrancy</span>, <span className="text-white">Sola Fide</span>, and <span className="text-white">Hermeneutics as Epistemology</span>.
                  </p>
                </div>
              </div>
              <div className="md:col-span-4">
                <div className="border border-white/10 p-8 space-y-8 sticky top-32">
                  <span className="text-[10px] font-black uppercase tracking-[0.4em] text-white">Core Academic Pillars</span>
                  <ul className="space-y-4 text-xs font-bold uppercase tracking-widest text-zinc-500">
                    <li className="flex items-center gap-3 text-zinc-300"><ShieldCheck className="w-3 h-3 text-white" /> Biblical Inerrancy</li>
                    <li className="flex items-center gap-3 text-zinc-300"><BookOpen className="w-3 h-3 text-white" /> Classical Apologetics</li>
                    <li className="flex items-center gap-3 text-zinc-300"><Scale className="w-3 h-3 text-white" /> Philosophical Theology</li>
                    <li className="flex items-center gap-3 text-zinc-300"><Feather className="w-3 h-3 text-white" /> Hermeneutics</li>
                  </ul>
                </div>
              </div>
            </div>
          </div>
        )}
      </main>

      {/* Subscription Form Section */}
      <section id="subscribe-section" className="py-40 bg-zinc-950 border-t border-white/5 relative z-10">
        <div className="max-w-xl mx-auto px-6 text-center">
          <span className="text-[10px] font-black uppercase tracking-[0.5em] text-zinc-500 mb-8 block">Join the Discourse</span>
          <h2 className="text-4xl font-black uppercase tracking-tighter text-white mb-12 italic">The Objective Faith Newsletter</h2>
          
          {formStatus === 'success' ? (
            <div className="bg-white/5 border border-white/20 p-12 animate-in zoom-in duration-300">
                <p className="text-white font-black uppercase tracking-widest text-sm">Thank you for joining the correspondence.</p>
                <p className="text-zinc-500 mt-2 text-xs">A confirmation has been sent to your inbox.</p>
            </div>
          ) : (
            <form onSubmit={handleFormSubmit} className="space-y-6">
              <div className="relative">
                <input 
                  id="email"
                  type="email" 
                  name="email" 
                  placeholder="Your Email Address" 
                  required 
                  className={`w-full bg-white/5 border ${formErrors.email ? 'border-red-500' : 'border-white/10'} focus:bg-white/10 focus:border-white/40 outline-none px-6 py-5 text-white text-sm uppercase tracking-widest placeholder:text-zinc-600 transition-all`}
                />
                {formErrors.email && <p className="text-red-500 text-[10px] mt-1 text-left uppercase tracking-widest font-black">{formErrors.email}</p>}
              </div>

              <div className="relative">
                <textarea 
                  id="message"
                  name="message" 
                  placeholder="Your Message" 
                  required
                  className={`w-full bg-white/5 border ${formErrors.message ? 'border-red-500' : 'border-white/10'} focus:bg-white/10 focus:border-white/40 outline-none px-6 py-5 text-white text-sm uppercase tracking-widest placeholder:text-zinc-600 transition-all min-h-[120px]`}
                />
                {formErrors.message && <p className="text-red-500 text-[10px] mt-1 text-left uppercase tracking-widest font-black">{formErrors.message}</p>}
              </div>
              
              <button 
                type="submit" 
                disabled={formStatus === 'submitting'}
                className="w-full bg-white text-black py-5 text-[11px] font-black uppercase tracking-[0.3em] hover:bg-zinc-200 transition-all disabled:opacity-50 disabled:cursor-not-allowed"
              >
                {formStatus === 'submitting' ? 'Transmitting...' : 'Send Message'}
              </button>
              
              {formStatus === 'error' && (
                <p className="text-red-500 text-[10px] mt-4 uppercase tracking-widest font-black text-center">
                  {formErrors.generic || "Something went wrong. Please check your details and try again."}
                </p>
              )}
            </form>
          )}
        </div>
      </section>

      {/* Footer */}
      <footer className="bg-black border-t border-white/10 pt-32 pb-12 relative z-10">
        <div className="max-w-7xl mx-auto px-6 text-center md:text-left">
          <div className="grid grid-cols-1 md:grid-cols-4 gap-20 mb-32">
            <div className="md:col-span-2">
              <div className="text-3xl font-black uppercase tracking-tighter mb-4 text-white">William C. Roach</div>
              <div className="text-[10px] font-bold tracking-[0.2em] uppercase text-zinc-500 mb-8">The Objective Faith</div>
              <p className="text-zinc-500 max-w-sm leading-relaxed text-sm mx-auto md:mx-0">
                Bridging the gap between the academy and the local church.
              </p>
              <div className="mt-8">
                <a href="mailto:roawil@gmail.com" className="text-xs font-black uppercase tracking-widest text-white border-b border-white/30 hover:border-white pb-1 transition-all">
                  roawil@gmail.com
                </a>
              </div>
            </div>
            <div className="flex flex-col gap-6">
              <span className="text-[10px] font-black uppercase tracking-[0.4em] text-white">Resources</span>
              <div className="flex flex-col gap-3 text-xs font-bold uppercase tracking-widest text-zinc-500">
                <a href="https://drbillroach.substack.com/" target="_blank" rel="noopener noreferrer" className="hover:text-white transition-colors">Substack</a>
                <a href="https://www.amazon.com/stores/William-C.-Roach/author/B01B22KJ1Y" target="_blank" rel="noopener noreferrer" className="hover:text-white transition-colors">Amazon Catalog</a>
                <button onClick={() => navigate('videos')} className="hover:text-white transition-colors text-left">YouTube</button>
              </div>
            </div>
            <div className="flex flex-col gap-6">
              <span className="text-[10px] font-black uppercase tracking-[0.4em] text-white">Connect</span>
              <div className="flex flex-col gap-4 text-zinc-500 items-center md:items-start">
                <a href="https://x.com/billroach_" target="_blank" rel="noopener noreferrer" className="flex items-center gap-3 text-xs font-bold uppercase tracking-widest hover:text-white">
                  <Twitter className="w-4 h-4" /> Twitter / X
                </a>
                <a href="https://www.youtube.com/@DrBillRoach" target="_blank" rel="noopener noreferrer" className="flex items-center gap-3 text-xs font-bold uppercase tracking-widest hover:text-white">
                  <Youtube className="w-4 h-4" /> YouTube
                </a>
                <a href="mailto:roawil@gmail.com" className="flex items-center gap-3 text-xs font-bold uppercase tracking-widest hover:text-white">
                  <Mail className="w-4 h-4" /> Contact
                </a>
              </div>
            </div>
          </div>
          <div className="pt-12 border-t border-white/5 flex flex-col md:flex-row justify-between items-center gap-8">
            <div className="text-[10px] font-black uppercase tracking-[0.3em] text-zinc-700">Â© 2026 William C. Roach.</div>
            <div className="text-[10px] font-black uppercase tracking-[0.3em] text-zinc-700">Built by <a href="https://ladmedia.co" target="_blank" rel="noopener noreferrer" className="hover:text-white transition-colors underline underline-offset-4 decoration-white/20">LAD MEDIA</a></div>
          </div>
        </div>
      </footer>
    </div>
  );
};

export default App;
